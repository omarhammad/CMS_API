<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="#{patient.title3}"></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.2/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/css/common.css}"/>
</head>
<body>
<div th:class="'container-fluid width-s-90  width-m-50 shadow p-3'">

    <div th:class="card">
        <div th:class="'card-header text-center'"><h4 th:class="'fw-bold'">Patient</h4></div>
        <div th:class="'card-body m-3'">
            <div>
                <i th:class="'bi bi bi-person-fill me-3 details-icons' "></i>
                <p th:class="'d-inline-block details-text'"
                   th:text="${#strings.concat(patient.getFirstName(),' ',patient.getLastName()).toUpperCase()}"></p>
            </div>
            <div>
                <i th:class="'bi bi-gender-ambiguous me-3 details-icons text-info' "></i>
                <p th:class="'d-inline-block details-text'"
                   th:text="${patient.getGender().toUpperCase()}"></p>
            </div>
            <div>
                <i th:class="'bi bi-balloon-fill me-3 details-icons text-success' "></i>
                <p th:class="'d-inline-block details-text'"
                   th:text="${patient.getAge()}"></p>
            </div>
            <div>
                <i th:class="'bi bi-person-vcard me-3 details-icons text-primary' "></i>
                <p th:class="'d-inline-block details-text'"
                   th:text="${patient.getNationalNumber()}"></p>
            </div>
            <div>
                <p th:class="details-icons-texts"><i th:class="'bi bi-calendar-heart me-3 text-success' "></i>
                    Appointment with Doctors: </p>
                <div th:class="text-center">
                    <p th:if="${hisDoctors.isEmpty()}" th:class="'h4 m-3'" th:text="'There is No appointments'"></p>
                    <p th:class="'d-block details-text'" th:each="doctor: ${hisDoctors}"
                       th:text="${#strings.concat(doctor.getFirstName(),' ',doctor.getLastName())}"></p>
                </div>
            </div>
            <!--Medical Records-->
            <div th:class="card">
                <div CLASS="card-header"><h3>Medical Records</h3></div>
                <div th:class="card-body">
                    <div th:class="'card-text text-center h5'" th:if="${lastAppointments.isEmpty()}">
                        NO MEDICAL RECORDS
                    </div>
                    <div th:class="'card-text m-2 mb-4 h5'" th:each="lastAppointment, status : ${lastAppointments}">
                        <span th:text="|${status.count}. On ${lastAppointment.getAppointmentDateTime().toLocalDate()} saw Dr. ${lastAppointment.getDoctor().getFirstName()} ${lastAppointment.getDoctor().getLastName()} for ${lastAppointment.getPurpose()} and prescribed him: |"></span>
                        <span th:if="${lastAppointment.getPrescription() != null}">
                            <span th:each="medication : ${lastAppointment.getPrescription().getMedications()}">
                                <span th:text="${medication.name}" th:unless="${medicationStat.last}"></span>
                                <span th:text="${medication.name + '.'}" th:if="${medicationStat.last}"></span>
                            </span>
    </span>
                        <span th:if="${lastAppointment.getPrescription() == null}">nothing.</span>
                    </div>


                </div>

            </div>
        </div>
        <div th:class="'card-footer text-center'"><a th:class="'btn btn-danger'" th:href="@{/patients/}">Back</a></div>

    </div>


</div>
<script th:src="@{/webjars/bootstrap/5.3.2/js/bootstrap.bundle.min.js}"></script>
</body>
</html>